<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joanna Kusy">
<meta name="author" content="Tomasz Srebniak">

<title>Analiza danych ankietowych</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Kusy_Srebniak_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Kusy_Srebniak_2_files/libs/quarto-html/quarto.js"></script>
<script src="Kusy_Srebniak_2_files/libs/quarto-html/popper.min.js"></script>
<script src="Kusy_Srebniak_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Kusy_Srebniak_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Kusy_Srebniak_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Kusy_Srebniak_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Kusy_Srebniak_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Kusy_Srebniak_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Kusy_Srebniak_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
</head><body class="fullcontent">\usepackage[OT4]{polski}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{float}

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analiza danych ankietowych</h1>
<p class="subtitle lead">Sprawozdanie 2</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Joanna Kusy </p>
             <p>Tomasz Srebniak </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div style="page-break-after: always;"></div>
<section id="część-i" class="level1">
<h1>Część I</h1>
<section id="zadanie-1" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-1">Zadanie 1</h2>
<p>W ankiecie przedstawionej na poprzedniej liście pracownicy zostali poproszeni o wyrażenie opinii na temat skuteczności szkolenia “Efektywna komunikacja w zespole” zorganizowanego przez firmę.</p>
<p>Na podstawie odpowiedzi wyznaczono realizację przedziału ufności dla wektora prawdopodobieństw opisującego stopień zadowolenia ze szkolenia. Przyjęto poziom ufności <span class="math inline">\(0.95\)</span> oraz zastosowano poprawkę Bonferroniego.</p>
<p>Realizacja przedziału ufności dla wektora prawdopodobieństw wyznaczonego metodą Cloppera–Pearsona.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ci_exact <span class="ot">&lt;-</span> <span class="fu">binom.confint</span>(res, <span class="dv">200</span>, <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">5</span>, <span class="at">method=</span><span class="st">'exact'</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ci_exact<span class="sc">$</span>len <span class="ot">&lt;-</span> ci_exact<span class="sc">$</span>upper <span class="sc">-</span> ci_exact<span class="sc">$</span>lower</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">method</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">lower</th>
<th style="text-align: right;">upper</th>
<th style="text-align: right;">len</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exact</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.0316965</td>
<td style="text-align: right;">0.1298937</td>
<td style="text-align: right;">0.0981972</td>
</tr>
<tr class="even">
<td style="text-align: left;">exact</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.0420814</td>
<td style="text-align: right;">0.1486579</td>
<td style="text-align: right;">0.1065765</td>
</tr>
<tr class="odd">
<td style="text-align: left;">exact</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">0.1325733</td>
<td style="text-align: right;">0.2821753</td>
<td style="text-align: right;">0.1496020</td>
</tr>
<tr class="even">
<td style="text-align: left;">exact</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.4073519</td>
<td style="text-align: right;">0.5926481</td>
<td style="text-align: right;">0.1852962</td>
</tr>
<tr class="odd">
<td style="text-align: left;">exact</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.0874987</td>
<td style="text-align: right;">0.2200467</td>
<td style="text-align: right;">0.1325481</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Realizacja przedziału ufności dla wektora prawdopodobieństw wyznaczonego metodą Wilsona.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">method</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">lower</th>
<th style="text-align: right;">upper</th>
<th style="text-align: right;">len</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">wilson</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.0360477</td>
<td style="text-align: right;">0.1315662</td>
<td style="text-align: right;">0.0955185</td>
</tr>
<tr class="even">
<td style="text-align: left;">wilson</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.0466063</td>
<td style="text-align: right;">0.1500444</td>
<td style="text-align: right;">0.1034382</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wilson</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">0.1373121</td>
<td style="text-align: right;">0.2819534</td>
<td style="text-align: right;">0.1446413</td>
</tr>
<tr class="even">
<td style="text-align: left;">wilson</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.4104047</td>
<td style="text-align: right;">0.5895953</td>
<td style="text-align: right;">0.1791906</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wilson</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.0922842</td>
<td style="text-align: right;">0.2205134</td>
<td style="text-align: right;">0.1282292</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Realizacja przedziału ufności dla wektora prawdopodobieństw wyznaczonego metodą asymptotyczną, opartą na Centralnym Twierdzeniu Granicznym.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">method</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">lower</th>
<th style="text-align: right;">upper</th>
<th style="text-align: right;">len</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">asymptotic</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.0235279</td>
<td style="text-align: right;">0.1164721</td>
<td style="text-align: right;">0.0929443</td>
</tr>
<tr class="even">
<td style="text-align: left;">asymptotic</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.0342049</td>
<td style="text-align: right;">0.1357951</td>
<td style="text-align: right;">0.1015903</td>
</tr>
<tr class="odd">
<td style="text-align: left;">asymptotic</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">0.1271445</td>
<td style="text-align: right;">0.2728555</td>
<td style="text-align: right;">0.1457109</td>
</tr>
<tr class="even">
<td style="text-align: left;">asymptotic</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.4089307</td>
<td style="text-align: right;">0.5910693</td>
<td style="text-align: right;">0.1821386</td>
</tr>
<tr class="odd">
<td style="text-align: left;">asymptotic</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.0808688</td>
<td style="text-align: right;">0.2091312</td>
<td style="text-align: right;">0.1282623</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Dla zadanych kategorii otrzymujemy proporcje:</p>
<ul>
<li><p><span class="math inline">\(0.070\)</span> – odsetek osób bardzo niezadowolonych,</p></li>
<li><p><span class="math inline">\(0.085\)</span> – odsetek osób niezadowolonych,</p></li>
<li><p><span class="math inline">\(0.200\)</span> – odsetek osób nie mających zdania,</p></li>
<li><p><span class="math inline">\(0.500\)</span> – odsetek osób zadowolonych,</p></li>
<li><p><span class="math inline">\(0.145\)</span> – odsetek osób bardzo zadowolonych.</p></li>
</ul>
<p>W zależności od wybranej metody, zmieniają się dolna i górna granica przedziału ufności. Dla kategorii z niewielką liczbą odpowiedzi (14 i 17 głosów) najwęższą realizację przedziału uzyskano przy zastosowaniu metody asymptotycznej. Wraz ze wzrostem liczby odpowiedzi (29 głosów), różnice w długości realizacji przedziałów wyznaczonych metodą asymptotyczną i metodą Wilsona stają się niewielkie. Dla kategorii, w których liczba odpowiedzi wynosiła 40 lub więcej, najwęższa realizacja przedziału została dzięki metodzie Wilsona. Metoda Cloppera–Pearsona nie dała najkrótszej realizacji przedziału dla żadnej z proporcji. Wynika to z faktu, że jest to metoda dokładna, która w sposób konserwatywny utrzymuje zadany poziom ufności.</p>
</section>
<section id="zadanie-2" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-2">Zadanie 2</h2>
<p>Napisano funkcję, która wyznacza wartość poziomu krytycznego w testach <span class="math inline">\(\chi^2\)</span> Pearsona oraz <span class="math inline">\(\chi^2\)</span> największej wiarogodności. Testy te służą do weryfikacji hipotezy <span class="math inline">\(H_0: \mathbf{p} = \mathbf{p_0}\)</span> przy hipotezie alternatywnej <span class="math inline">\(H_1:\mathbf{p} \neq \mathbf{p_0}\)</span> na podstawie obserwacji <span class="math inline">\(\mathbf{x}\)</span> wektora losowego <span class="math inline">\(\mathbf{X}\)</span> z rozkładu wielomianowego z parametrami <span class="math inline">\(n\)</span> i <span class="math inline">\(\mathbf{p}\)</span>.</p>
<section id="test-chi2-pearsona" class="level3">
<h3 class="anchored" data-anchor-id="test-chi2-pearsona">Test <span class="math inline">\(\chi^2\)</span> Pearsona</h3>
<p>Statystyką testową w teście jest <span class="math display">\[
\chi^2 = \sum_{i=1}^k\frac{(X_i - np_{0i})^2}{np_{0i}},
\]</span> gdzie <span class="math inline">\(p_{0i}\)</span> jest i–tą składową wektora <span class="math inline">\(\mathbf{p}\)</span>. Przy założeniu, że <span class="math inline">\(H_0\)</span> jest prawdziwa statystyka <span class="math inline">\(\chi^2\)</span> ma asymptotycznie rozkład <span class="math inline">\(\chi^2\)</span> z <span class="math inline">\(k-1\)</span> stopniami swobody. </p>
<p>Wartość poziomu krytycznego liczymy jako <span class="math display">\[
p–value=1-F_{\chi_{k-1}^2}(\chi^2(\mathbf{x})),
\]</span> gdzie <span class="math inline">\(F_{\chi_{k-1}^2}\)</span> jest dystrybuantą rozkładu <span class="math inline">\(\chi^2\)</span> z <span class="math inline">\(k-1\)</span> stopniami swobody, a <span class="math inline">\(\chi^2(\mathbf{x})\)</span> wartością statystki dla realizacji <span class="math inline">\(\mathbf{x}\)</span>. </p>
</section>
<section id="test-chi2-największej-wiarogodności" class="level3">
<h3 class="anchored" data-anchor-id="test-chi2-największej-wiarogodności">Test <span class="math inline">\(\chi^2\)</span> największej wiarogodności</h3>
<p>Statystyką testową w teście IW jest <span class="math display">\[
G^2 = 2\sum_{i=1}^kX_i\ln\bigg(\frac{X_i}{np_{0i}}\bigg)
\]</span> Przy założeniu, że <span class="math inline">\(H_0\)</span> jest prawdziwa statystyka <span class="math inline">\(G^2\)</span> ma asymptotycznie rozkład <span class="math inline">\(\chi^2\)</span> z <span class="math inline">\(k-1\)</span> stopniami swobody. </p>
<p>Wartość poziomu krytycznego liczymy jako <span class="math display">\[
p–value=1-F_{\chi_{k-1}^2}(G^2(\mathbf{x})),
\]</span> gdzie <span class="math inline">\(F_{\chi_{k-1}^2}\)</span> jest dystrybuantą rozkładu <span class="math inline">\(\chi^2\)</span> z <span class="math inline">\(k-1\)</span> stopniami swobody, a <span class="math inline">\(G^2(\mathbf{x})\)</span> wartością statystki dla realizacji <span class="math inline">\(\mathbf{x}\)</span>. </p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>chi_sq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p0, <span class="at">method=</span><span class="st">'pearson'</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">'pearson'</span>) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    Chi2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> n <span class="sc">*</span> p0)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n <span class="sc">*</span> p0))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    p_val <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(Chi2, <span class="fu">length</span>(x) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"p-value:"</span>, p_val))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">'IW'</span>) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    G2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(x <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">/</span> (n <span class="sc">*</span> p0)))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    p_val <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(G2, <span class="fu">length</span>(x) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"p-value:"</span>, p_val))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dla danych z poprzedniego zadania i <span class="math inline">\(H_0: \mathbf{p} = (0.1, 0.2, 0.4, 0.2, 0.1)\)</span> za pomocą funkcji otrzymamy następujące wartości poziomu krytycznego:</p>
<ul>
<li>dla testu <span class="math inline">\(\chi^2\)</span> Pearsona</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chi_sq_test</span>(res, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>), <span class="at">method=</span><span class="st">'pearson'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p-value: 0"</code></pre>
</div>
</div>
<ul>
<li>dla testu <span class="math inline">\(\chi^2\)</span> największej wiarogodności</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chi_sq_test</span>(res, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>), <span class="at">method=</span><span class="st">'IW'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p-value: 0"</code></pre>
</div>
</div>
<p>Dla obu testów dla zadanego poziomu istotności <span class="math inline">\(\alpha =0.05\)</span> odrzucamy hipotezę zerową <span class="math inline">\(H_0\)</span> na rzecz hipotezy alternatywnej <span class="math inline">\(H_1: \mathbf{p} \neq (0.1, 0.2, 0.4, 0.2, 0.1)\)</span>.</p>
</section>
</section>
<section id="zadanie-3" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-3">Zadanie 3</h2>
<p>Na podstawie danych z ankiety z poprzedniej listy zweryfikowano hipotezę, że w grupie pracowników zatrudnionwych w Dziale Produktowym rozkład odpowiedzi na pytanie “Jak bardzo zgadzasz się ze stwierdzeniem, że firma zapewnia odpowiednie wsparcie i materiały umożliwiające skuteczne wykorzystanie w praktyce wiedzy zdobytej w trakcie szkoleń?” jest równomierny. Przyjęto poziom istotności 0.05. Skorzystano z funkcji napisanej w zadaniu 2.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chi_sq_test</span>(vec, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">method=</span><span class="st">'pearson'</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p-value: 2.75779399316889e-13"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chi_sq_test</span>(vec, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">method=</span><span class="st">'IW'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p-value: 1.07019948458742e-10"</code></pre>
</div>
</div>
<p>Dla obu testów dla zadanego poziomu istotności <span class="math inline">\(\alpha =0.05\)</span> odrzucamy hipotezę o równomiernym rozkładzie odpowiedzi.</p>
</section>
</section>
<section id="część-ii" class="level1">
<h1>Część II</h1>
<section id="zadanie-4" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-4">Zadanie 4</h2>
<p>W pakiecie R do wykonania zarówno testu Fishera, jak i testu Freemana – Haltona, można posłużyć się funkcją <em>fisher.test</em> z biblioteki <em>stats</em>.</p>
<p>Przyjmuje ona następujące argumenty:</p>
<ul>
<li><em>x</em> – dwuwymiarowa tabela kontyngencji w postaci macierzy lub obiektu typu factor,</li>
<li><em>y = NULL</em> – opcjonalny drugi obiekt typu factor. Używany tylko wtedy, gdy <em>x</em> nie jest macierzą,</li>
<li><em>workspace = 200000</em> – ilość pamięci roboczej w bajtach przeznaczonej na obliczenia (stosowane tylko dla tabel większych niż 2×2 przy podejściu dokładnym, bez symulacji p-value),</li>
<li><em>hybrid = FALSE</em> – wartość logiczna określająca, czy zastosować algorytm hybrydowy (dotyczy tylko tabel większych niż 2×2),</li>
<li><em>hybridPars = c(expect = 5, percent = 80, Emin = 1)</em> – wektor określający “warunki Cochrana” dla poprawności aproksymacji chi–kwadrat,</li>
<li><em>control = list()</em> – lista z nazwanymi komponentami do niskopoziomowej kontroli algorytmu,</li>
<li><em>or = 1</em> – wartość hipotetycznego ilorazu szans (stosowane wyłącznie dla tabel 2×2),</li>
<li><em>alternative = “two.sided”</em> – typ hipotezy alternatywnej (“two.sided”, “less”, “greater”) – stosowane wyłącznie dla tabel 2×2,</li>
<li><em>conf.int = TRUE</em> – wartość logiczna wskazująca, czy obliczyć przedział ufności dla ilorazu szans (dotyczy tylko tabel 2×2),</li>
<li><em>conf.level = 0.95</em> – poziom ufności dla przedziału ufności ilorazu szans. Używana tylko przy tabelach o rozmiarach 2x2,</li>
<li><em>simulate.p.value = FALSE</em> – wartość logiczna określająca, czy <em>p-value</em> ma zostać oszacowane za pomocą symulacji Monte Carlo (dotyczy tylko tabel większych niż 2×2),</li>
<li><em>B = 2000</em> – liczba symulacji Monte Carlo.</li>
</ul>
<p>Funkcja zwraca obiekt klasy <em>htest</em>, który zawiera następujące elementy:</p>
<ul>
<li><em>p.value</em> – p wartość testu,</li>
<li><em>conf.int</em> – przedział ufności dla ilorazu szans (jeśli <em>conf.int = TRUE</em> i tabela ma rozmiar 2x2),</li>
<li><em>estimate</em> – estymowana wartość ilorazu szans (tylko dla tabel 2x2),</li>
<li><em>null–value</em> – wartość ilorazu szans podana w argumencie <em>or</em> (tylko dla tabel 2x2),</li>
<li><em>alternative</em> – typ hipotezy alternatywnej,</li>
<li><em>method</em> – napis “Fisher’s Exact Test for Count Data”,</li>
<li><em>data.name</em> – nazwa danych przekazanych do testu.</li>
</ul>
</section>
<section id="zadanie-5" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-5">Zadanie 5</h2>
<p>Korzystając z testu Fishera, na poziomie istotności 0.05, zweryfikowano hipotezę o niezależności zmiennych <strong>PŁEĆ</strong> i <strong>CZY_KIER</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PŁEĆ, ankieta<span class="sc">$</span>CZY_KIER)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(contingency_table, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  contingency_table
p-value = 0.6659
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.5299411 3.8023038
sample estimates:
odds ratio 
  1.358208 </code></pre>
</div>
</div>
<p>P–value jest większe niż zadany poziom istotności, zatem nie mamy podstaw do odrzucenia hipotezy zerowej. Niezależność jest równoważne równości prawdopodobieństw warunkowych. Na poziomie istotności 0.05 możemy wnioskować, że prawdopodobieństwo tego, że na stanowisku kierowniczym pracuje kobieta jest równe prawdopodobieństwu tego, że na stanowisku kierowniczym pracuje mężczyzna.</p>
</section>
<section id="zadanie-6" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-6">Zadanie 6</h2>
<p>Korzystajac z testu Freemana-Haltona na poziomie istotności 0.05 zweryfikowano hipotezy dotyczące omawianych zmiennych.</p>
<section id="podpunkt-a" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-a">Podpunkt a</h3>
<p>Zajmowanie stanowiska kierowniczego nie zależy od wieku.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>CZY_KIER, ankieta<span class="sc">$</span>WIEK_KAT)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.7823
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 nie mamy podstaw do odrzucenia hipotezy zerowej. Zakładamy, że zajmowanie stanowiska kierowniczego i wiek są zmiennymi niezależnymi.</p>
</section>
<section id="podpunkt-b" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-b">Podpunkt b</h3>
<p>Zajmowanie stanowiska kierowniczego nie zależy od stażu pracy.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>CZY_KIER, ankieta<span class="sc">$</span>STAŻ)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 6.538e-05
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 odrzucucamy hipotezę zerową. Zakładamy, że zmienne dotyczące zajmowania stanowiska kierowniczego oraz stażu pracy są zależne.</p>
</section>
<section id="podpunkt-c" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-c">Podpunkt c</h3>
<p>Stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie nie zależy od zajmowanego stanowiska.</p>
<p>Zmienne <strong>PYT_2</strong> oraz <strong>CZY_KIER</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PYT_2, ankieta<span class="sc">$</span>CZY_KIER)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.0443
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 odrzucamy hipotezę zerową. Zakładamy, że zajmowanie stanowiska kierowniczego i stopień zadowolenia ze szkoleń są zmiennymi zależnymi.</p>
<p>Zmienne <strong>CZY_ZADOW</strong> oraz <strong>CZY_KIER</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>CZY_ZADOW, ankieta<span class="sc">$</span>CZY_KIER)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.8377
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.4612836 2.8018002
sample estimates:
odds ratio 
  1.125705 </code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 nie mamy podstaw do odrzucenia hipotezy zerowej. Zakładamy, że zajmowanie stanowiska kierowniczego i stopień zadowolenia ze szkoleń są zmiennymi niezależnymi.</p>
</section>
<section id="podpunkt-d" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-d">Podpunkt d</h3>
<p>Stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie nie zależy od stażu.</p>
<p>Zmienne <strong>PYT_2</strong> oraz <strong>STAŻ</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PYT_2, ankieta<span class="sc">$</span>STAŻ)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.01069
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 odrzucamy hipotezę zerową. Zakładamy, że staż pracy i stopień zadowolenia ze szkoleń są zmiennymi zależnymi.</p>
<p>Zmienne <strong>CZY_ZADOW</strong> oraz <strong>STAŻ</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>CZY_ZADOW, ankieta<span class="sc">$</span>STAŻ)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.4097
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 nie mamy podstaw do odrzucenia hipotezy zerowej. Zakładamy, że staż pracy i stopień zadowolenia ze szkoleń są zmiennymi niezależnymi.</p>
</section>
<section id="podpunkt-e" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-e">Podpunkt e</h3>
<p>Stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie nie zależy od płci.</p>
<p>Zmienne <strong>PYT_2</strong> oraz <strong>PŁEĆ</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PYT_2, ankieta<span class="sc">$</span>PŁEĆ)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.4758
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 nie mamy podstaw do odrzucenia hipotezy zerowej. Zakładamy, że płeć pracownika i stopień zadowolenia ze szkoleń są zmiennymi niezależnymi.</p>
<p>Zmienne <strong>CZY_ZADOW</strong> oraz <strong>PŁEĆ</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>CZY_ZADOW, ankieta<span class="sc">$</span>PŁEĆ)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.6589
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.6194413 2.1460710
sample estimates:
odds ratio 
  1.152656 </code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 nie mamy podstaw do odrzucenia hipotezy zerowej. Zakładamy, że płeć pracownika i stopień zadowolenia ze szkoleń są zmiennymi niezależnymi.</p>
</section>
<section id="podpunkt-f" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-f">Podpunkt f</h3>
<p>Stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie nie zależy od wieku.</p>
<p>Zmienne <strong>PYT_2</strong> oraz <strong>WIEK_KAT</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PYT_2, ankieta<span class="sc">$</span>WIEK_KAT)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">workspace =</span> <span class="fl">2e7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.3194
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 nie mamy podstaw do odrzucenia hipotezy zerowej. Zakładamy, że wiek pracownika i stopień zadowolenia ze szkoleń są zmiennymi niezależnymi.</p>
<p>Zmienne <strong>CZY_ZADOW</strong> oraz <strong>WIEK_KAT</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>CZY_ZADOW, ankieta<span class="sc">$</span>WIEK_KAT)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(t, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  t
p-value = 0.3275
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Na poziomie istotności 0.05 nie mamy podstaw do odrzucenia hipotezy zerowej. Zakładamy, że wiek pracownika i stopień zadowolenia ze szkoleń są zmiennymi niezależnymi.</p>
</section>
<section id="porównanie-wyników" class="level3">
<h3 class="anchored" data-anchor-id="porównanie-wyników">Porównanie wyników</h3>
<p>W zależności od tego, czy do testowania hipotezy wykorzystaliśmy zmienną łączącą kategorie, czy też nie, w podpunktach c i d uzyskaliśmy różne wyniki. Natomiast w podpunktach e i f w obu przypadkach podjęliśmy decyzję o nieodrzuceniu hipotezy zerowej. We wszystkich omawianych przykładach p–value było większe przy wykorzystaniu zmiennej <strong>CZY_ZADOW</strong>.</p>
</section>
</section>
</section>
<section id="część-iii" class="level1">
<h1>Część III</h1>
<section id="zadanie-7" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-7">Zadanie 7</h2>
<p>Do wykonania testu niezależności Chi-kwadrat w R można użyć funkcji <em>chisq.test</em> z pakietu <em>stats</em>.</p>
<p>Funkcja ta przyjmuje następujące argumenty:</p>
<ul>
<li><p><em>x</em> – wektor lub macierz,</p></li>
<li><p><em>y</em> – wektor, ignorowany, jeśli <em>x</em> jest macierzą,</p></li>
<li><p><em>correct</em> – wartość logiczna określająca, czy zastosowana zostanie poprawka Yatesa,</p></li>
<li><p><em>p</em> – wektor prawdopodobieństw,</p></li>
<li><p><em>rescale.p</em> – wartość logiczna określająca, czy przeskalować wektor prawdopodobieństw tak, aby sumował się do 1,</p></li>
<li><p><em>simulate.p.value</em> – wartość logiczna określająca, czy <em>p-value</em> oszacowane zostanie za pomocą symulacji Monte Carlo,</p></li>
<li><p><em>B</em> – liczba symulacji Monte Carlo.</p></li>
</ul>
<p>Funkcja zwraca obiekt klasy <em>htest</em>, który zawiera następujące elementy:</p>
<ul>
<li><p><em>statistic</em> – wartość statystyki testowej,</p></li>
<li><p><em>parameter</em> – liczba stopni swobody,</p></li>
<li><p><em>p.value</em> – p wartość testu,</p></li>
<li><p><em>method</em> – napis mówiący o typie wykonanego testu, określający, czy zastosowano poprawkę Yatesa oraz, czy użyto symulacji Monte Carlo,</p></li>
<li><p><em>data.name</em> – nazwa danych przekazanych do testu,</p></li>
<li><p><em>observed</em> – obserwowane wartości,</p></li>
<li><p><em>expected</em> – oczekiwane wartości przy założeniu hipotezy zerowej,</p></li>
<li><p><em>residuals</em> – reszty Pearsona,</p></li>
<li><p><em>stdres</em> – standaryzowane residua.</p></li>
</ul>
</section>
<section id="zadanie-8" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-8">Zadanie 8</h2>
<p>Korzystając z funkcji <em>chisq.test</em> zweryfikowano hipotezę, że stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie nie zależy od zajmowanego stanowiska. Przyjęto poziom istotności 0.01.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PYT_2, ankieta<span class="sc">$</span>CZY_KIER)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(t, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  t
X-squared = 13.114, df = 3, p-value = 0.004397</code></pre>
</div>
</div>
<p>P–value jest mniejsze niż zadany poziom istotności, zatem odrzucamy hipotezę zerową na rzecz hipotezy alternatywnej. Zakładamy, że zajmowanie stanowiska kierowniczego i stopień zadowolenia ze szkoleń są zmiennymi zależnymi. Wynik jest taki sam, jak w zadaniu 6c, gdy pod uwagę braliśmy te same zmienne.</p>
<p>Poniżej zaprezentowano wykres asocjacyjny reszt wyznaczonych w teście.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assocplot</span>(t, <span class="at">main =</span> <span class="st">"Wykres asocjacyjny wyznaczonych reszt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><embed src="Kusy_Srebniak_2_files/figure-html/zad8_wykres-1.pdf" class="img-fluid quarto-figure quarto-figure-center" data-fig-pos="H" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Z wykresu wynika, że odpowiedzi -1 oraz 2 było więcej wśród osób, które nie zajmują stanowiska kierowniczego. Odpowiedź 1 były bardziej powszechna wśród osób, które zajmują stanowisko kierownicze. Odpowiedź -2 nie była częsciej wskazywana przez żadną z grup.</p>
</section>
<section id="zadanie-9" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-9">Zadanie 9</h2>
<p>W pakiecie R do generowania wektorów losowych z rozkładu wielomianowego można posłużyć się funkcją <em>rmultinom</em> z pakietu <em>stats</em>.</p>
<p>Funkcja ta przyjmuje następujące argumenty:</p>
<ul>
<li><p><em>n</em> – liczba wektorów losowych,</p></li>
<li><p><em>size</em> – liczba prób,</p></li>
<li><p><em>prob</em> – wektor prawdopodobieństw.</p></li>
</ul>
<p>Dla danych wygenerowanych z tabeli, w której <span class="math inline">\(p_{11} = \frac{1}{40}\)</span>, <span class="math inline">\(p_{12} = \frac{3}{40}\)</span>, <span class="math inline">\(p_{21} = \frac{19}{40}\)</span>, <span class="math inline">\(p_{22} = \frac{17}{40}\)</span>, przeprowadzano symulacje w celu oszacowania mocy testu Fishera oraz mocy testu chi–kwadrat Pearsona. Symulacje wykonano dla <span class="math inline">\(n \in \{50, 100, 1000\}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># dla powtarzalności</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parametry</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">19</span>, <span class="dv">17</span>) <span class="sc">/</span> <span class="dv">40</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Funkcja <em>simulate_power</em> przeprowadza symulacje dla zadanych parametrów oblicza moce rozważanych testów. W każdej iteracji generowany jest wektor losowy z rozkładu wielomianowego, na podstawie którego, za pomocą funkcji bibliotecznych, obliczane są p–values. Dzieląc liczbę odrzuconych hipotez zerowych przez liczbę iteracji, otrzymujemy estymowaną wartość mocy testu.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do przeprowadzenia symulacji</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>simulate_power <span class="ot">&lt;-</span> <span class="cf">function</span>(n, iter, prob, alpha) {</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  fisher_rejections <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  chisq_rejections <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    sample <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> prob)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(sample, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    fisher_p <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(table)<span class="sc">$</span>p.value</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    chisq_p <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">chisq.test</span>(table, <span class="at">correct =</span> <span class="cn">FALSE</span>, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    iter_chisq <span class="ot">&lt;-</span> iter</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fisher_p <span class="sc">&lt;</span> alpha) {</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>      fisher_rejections <span class="ot">&lt;-</span> fisher_rejections <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(chisq_p) <span class="sc">&amp;&amp;</span> chisq_p <span class="sc">&lt;</span> alpha) {</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>      chisq_rejections <span class="ot">&lt;-</span> chisq_rejections <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(chisq_p)) {</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>      iter_chisq <span class="ot">&lt;-</span> iter_chisq <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  fisher_power <span class="ot">&lt;-</span> fisher_rejections <span class="sc">/</span> iter</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  chisq_power <span class="ot">&lt;-</span> chisq_rejections <span class="sc">/</span> iter_chisq</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">Fisher =</span> fisher_power, <span class="at">ChiSq =</span> chisq_power))</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Poniżej przedstawiono wyniki symulacji.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">n = 50</th>
<th style="text-align: right;">n = 100</th>
<th style="text-align: right;">n = 1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fisher</td>
<td style="text-align: right;">0.1174</td>
<td style="text-align: right;">0.3161</td>
<td style="text-align: right;">0.9995</td>
</tr>
<tr class="even">
<td style="text-align: left;">ChiSq</td>
<td style="text-align: right;">0.1199</td>
<td style="text-align: right;">0.3145</td>
<td style="text-align: right;">0.9995</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Wraz ze wzrostem wartości <span class="math inline">\(n\)</span> rośnie moc testu. Dla <span class="math inline">\(n=50\)</span> moc testu chi–kwadrat Pearsona jest większa od mocy testu Fishera. Dla <span class="math inline">\(n=100\)</span> jest odwrotnie. Przy <span class="math inline">\(n=1000\)</span> moce testów są równe z dokładnością do 4 miejsc po przecinku.</p>
</section>
<section id="zadanie-10" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-10">Zadanie 10</h2>
<p>Napisano funkcję, która dla danych z tablicy dwudzielczej oblicza wartość poziomu krytycznego w teście niezależności opartym na ilorazie wiarogodności.</p>
<p>Statystyką testową w teście jest</p>
<p><span class="math display">\[
G^2 = \sum_{i=1}^k\sum_{j=1}^kO_{ij}\ln{\Big(\frac{O_{ij}}{E_{ij}}\Big)},
\]</span></p>
<p>gdzie <span class="math inline">\(O_{i, j}\)</span> to obserowana wartość, a <span class="math inline">\(E_{i, j}\)</span> to wartość spodziewana policzona według wzoru <span class="math inline">\(E_{i, j}=\frac{O_{i+}O_{+j}}{n}\)</span>.</p>
<p>P–value obliczymy posługując się wzorem</p>
<p><span class="math display">\[
p–value=1-F_{\chi_{(R-1)(C-1)}^2}(G^2),
\]</span></p>
<p>gdzie <span class="math inline">\(F_{\chi_{(R-1)(C-1)}^2}\)</span> jest dystrybuantą rozkładu <span class="math inline">\(\chi^2\)</span> z <span class="math inline">\((R-1)(C-1)\)</span> stopniami swobody.</p>
<p>Na podstawie opisanego schematu funkcja <em>lr_test_p–value</em> oblicza wartość poziomu krytycznego w teście niezależności opartym na ilorazie wiarogodności.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>lr_test_pvalue <span class="ot">&lt;-</span> <span class="cf">function</span>(table) {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Obserwacje</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> table</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Oczekiwane liczności pod H0 (niezależność)</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  row_totals <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(observed)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  col_totals <span class="ot">&lt;-</span> <span class="fu">colSums</span>(observed)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_totals, col_totals) <span class="sc">/</span> total</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wykluczenie zer (dla bezpieczeństwa w log)</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  valid <span class="ot">&lt;-</span> observed <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Obliczenie statystyki G^2</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  G2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(observed[valid] <span class="sc">*</span> <span class="fu">log</span>(observed[valid] <span class="sc">/</span> expected[valid]))</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Stopnie swobody: (r-1)(c-1)</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(observed) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">ncol</span>(observed) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Obliczenie p-value</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(G2, <span class="at">df =</span> df)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p_value)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Korzystając z napisanej funkcji, wykonano test dla danych przeanalizowanych w zadaniu 8.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PYT_2, ankieta<span class="sc">$</span>CZY_KIER)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lr_test_pvalue</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03968956</code></pre>
</div>
</div>
<p>Przyjmjując za poziom istotności 0.05, odrzucamy hipotezę zerową na rzecz hipotezy alternatywnej. Zakładamy, że zajmowane stanowisko kierownicze i stopień zadowolenia ze szkoleń są zmiennymi zależnymi. Wynik jest taki sam, jak w zadaniu 8.</p>
</section>
</section>
<section id="część-iv-i-v" class="level1">
<h1>Część IV i V</h1>
<section id="zadanie-11" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-11">Zadanie 11</h2>
<p>Przeprowadzone wsród brytyjskich mężczyzn badanie trwające 20 lat wykazało, że odsetek zmarłych (na rok) z powodu raka płuc wynosił 0.00140 wsród osób palących papierosy i 0.00010 wsród osób niepalących. Odsetek zmarłych z powodu choroby niedokrwiennej serca wynosił 0.00669 dla palaczy i 0.00413 dla osób niepalących.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Rak płuc</th>
<th style="text-align: right;">Choroba niedokrwienna serca</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Palenie</td>
<td style="text-align: right;">0.0014</td>
<td style="text-align: right;">0.00669</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nie palenie</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">0.00413</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="różnica-proporcji" class="level3">
<h3 class="anchored" data-anchor-id="różnica-proporcji">Różnica proporcji</h3>
<p>Różnica proporcji dla palaczy i osób niepalących wynosi 0.0013 dla raka płuc oraz 0.00256 dla choroby niedokrwiennej serca. Obie wartości są bliskie 0, które jest równoważne z niezależnością zmiennych. Warto jednak zauważyć, że różnica proporcji dla choroby niedokrwiennej serca jest ponad 2 razy większa niż dla raka płuc.</p>
</section>
<section id="ryzyko-względne" class="level3">
<h3 class="anchored" data-anchor-id="ryzyko-względne">Ryzyko względne</h3>
<p>Ryzyko względne dla palaczy i osób niepalących wynosi 14 dla raka płuc oraz około 1.6199 dla choroby niedokrwiennej serca. Obie wartości są większe od 1, co wskazuje na związek zmiennych. Ryzyko zgonu na raka płuc jest ponad 14 razy większe dla palaczy niż dla osób niepalących. Dla choroby niedokrwiennej serca ryzyko zgonu dla palacza jest większe o około 1.62.</p>
</section>
<section id="iloraz-szans" class="level3">
<h3 class="anchored" data-anchor-id="iloraz-szans">Iloraz szans</h3>
<p>Iloraz szans dla palaczy i osób niepalących wynosi około 14.0182 dla raka płuc oraz 1.624 dla choroby niedokrwiennej serca. Oba ilorazy są większe od 1, co oznacza, że szansa zgonu z powodu tych chorób jest wyższa wśród palaczy niż wśród osób niepalących.. Większe odchylenie od 1 wskazuje na silniejszy związek, co w tym przypadku ma miejsce dla raka płuc.</p>
</section>
</section>
<section id="zadanie-12" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-12">Zadanie 12</h2>
<p>Poniższa tabela przedstawia wyniki dotyczące śmiertelności kierowców i pasażerów w wypadkach samochodowych na Florydzie w 2008 roku, w zależności od tego, czy osoba miała zapięty pas bezpieczeństwa czy nie.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">śmiertelny</th>
<th style="text-align: right;">nieśmiertelny</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bez pasów</td>
<td style="text-align: right;">1085</td>
<td style="text-align: right;">55623</td>
</tr>
<tr class="even">
<td style="text-align: left;">z pasami</td>
<td style="text-align: right;">703</td>
<td style="text-align: right;">441239</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="podpunkt-a-1" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-a-1">Podpunkt a</h3>
<p>Warunkowe prawdopodobieństwo śmierci w wypadku ze względu na użycie przez kierowców i pasażerów pasa bezpieczeństwa wynosi 0.0015907.</p>
<p>Warunkowe prawdopodobieństwo śmierci w wypadku ze względu na nieużycie przez kierowców i pasażerów pasa bezpieczeństwa wynosi 0.0191331.</p>
</section>
<section id="podpunkt-b-1" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-b-1">Podpunkt b</h3>
<p>Warunkowe prawdopodobieństwo użycia pasa bezpieczeństwa ze względu na kierowców i pasażerów ze śmiertelnymi obrażeniami wynosi 0.3931767.</p>
<p>Warunkowe prawdopodobieństwo użycia pasa bezpieczeństwa ze względu na kierowców i pasażerów, którzy przeżyli wypadek wynosi 0.8880514.</p>
</section>
<section id="podpunkt-c-1" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-c-1">Podpunkt c</h3>
<p>Naturalnym wyborem zmiennej objaśniającej jest zmienna dotycząca użycia pasa bezpieczeństwa. Poprzez taki wybór traktujemy śmierć w wypadku jako zmienną objaśnianą.</p>
<section id="różnica-proporcji-1" class="level4">
<h4 class="anchored" data-anchor-id="różnica-proporcji-1">Różnica proporcji</h4>
<p>Różnica proporcji dla osób z niezapiętymi i zapiętymi pasami wynosi 0.0175424. Wartość ta jest nieweiele większa od 0, co może wskazywać na słabą zależność zmiennych.</p>
</section>
<section id="ryzyko-względne-1" class="level4">
<h4 class="anchored" data-anchor-id="ryzyko-względne-1">Ryzyko względne</h4>
<p>Ryzyko względne dla osób z niezapiętymi i zapiętymi pasami wynosi 12.0280537. Wartość ta jest większa od 1, co wskazuje na związek zmiennych. Ryzyko śmierci w wypadku dla osób z niezapiętymi pasami jest około 12.0281 razy większe niż dla osób z zapiętymi pasami.</p>
</section>
<section id="iloraz-szans-1" class="level4">
<h4 class="anchored" data-anchor-id="iloraz-szans-1">Iloraz szans</h4>
<p>Iloraz szans dla osób z niezapiętymi i zapiętymi pasami wynosi 12.2432 i jest większy od 1, co oznacza, że szansa śmierci w wypadku jest większa dla osób bez pasów niż dla osób z zapiętym pasem bezpieczeństwa.</p>
<p>Ryzyko względne oraz iloraz szans przyjmują&nbsp;podobne wartości ze względu na małą liczbę&nbsp;śmiertelnych wypadków.</p>
</section>
</section>
</section>
<section id="zadanie-13" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-13">Zadanie 13</h2>
<p>Obliczono wartości odpowiednich miar współzmienności dla niektórych z wcześniej omawianych zmiennych.</p>
<section id="podpunkt-a-2" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-a-2">Podpunkt a</h3>
<p>Stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie (zmienna CZY_ZADOW) i zajmowane stanowisko.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>CZY_ZADOW, ankieta<span class="sc">$</span>CZY_KIER)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">GoodmanKruskalTau</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0004091802</code></pre>
</div>
</div>
<p>Wartość współczynnika <span class="math inline">\(\tau\)</span> jest bliska zeru, co wskazuje na brak istotnej zależności między zmiennymi. Dodatkowo w zadaniu 6c, na podstawie testu Freemana–Haltona przy poziomie istotności 0.05, nie odrzuciliśmy hipotezy o niezależności. Uwzględniając oba wyniki, można wnioskować o braku zależności między analizowanymi zmiennymi.</p>
</section>
<section id="podpunkt-b-2" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-b-2">Podpunkt b</h3>
<p>Stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie i staż pracy.</p>
<section id="współczynnik-tau" class="level4">
<h4 class="anchored" data-anchor-id="współczynnik-tau">Współczynnik <span class="math inline">\(\tau\)</span></h4>
<p>Jako zmienną mierzącą stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie przyjęto zmienną <strong>CZY_ZADOW</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>CZY_ZADOW, ankieta<span class="sc">$</span>STAŻ)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">GoodmanKruskalTau</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.008886788</code></pre>
</div>
</div>
<p>Wartość współczynnika <span class="math inline">\(\tau\)</span> jest bliska zeru, co wskazuje na brak istotnej zależności między zmiennymi. Dodatkowo w zadaniu 6d, na podstawie testu Freemana–Haltona przy poziomie istotności 0.05, nie odrzuciliśmy hipotezy o niezależności. Uwzględniając oba wyniki, można wnioskować o braku zależności między analizowanymi zmiennymi.</p>
</section>
<section id="współczynnik-gamma" class="level4">
<h4 class="anchored" data-anchor-id="współczynnik-gamma">Współczynnik <span class="math inline">\(\gamma\)</span></h4>
<p>Jako zmienną mierzącą stopień zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie przyjęto zmienną <strong>PYT_2</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PYT_2, ankieta<span class="sc">$</span>STAŻ)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">GoodmanKruskalGamma</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09084262</code></pre>
</div>
</div>
<p>Wartość współczynnika <span class="math inline">\(\gamma\)</span> jest większa od zera, co wskazuje na dodatnią zależność między zmiennymi. Oznacza to, że wyższe kategorie jednej zmiennej mają tendencję do współwystępowania z wyższymi kategoriami drugiej zmiennej. Dodatkowo, w zadaniu 6d na podstawie testu Freemana–Haltona przy poziomie istotności 0.05, odrzuciliśmy hipotezę o niezależności zmiennych. Uwzględniając oba wyniki, można wnioskować o istnieniu zależności między analizowanymi zmiennymi.</p>
</section>
</section>
<section id="podpunkt-c-2" class="level3">
<h3 class="anchored" data-anchor-id="podpunkt-c-2">Podpunkt c</h3>
<p>Zajmowane stanowisko i staż pracy.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>DZIAŁ, ankieta<span class="sc">$</span>STAŻ)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">GoodmanKruskalTau</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1226655</code></pre>
</div>
</div>
<p>Wartość współczynnika <span class="math inline">\(\tau\)</span> jest większa od zera, co wskazuje na zależności między zmiennymi. Dodatkowo w zadaniu 6b, na podstawie testu Freemana–Haltona przy poziomie istotności 0.05, odrzuciliśmy hipotezę o niezależności zmiennych. Niskie p-value świadczy o statystycznie istotnej zależności między zmiennymi. Uwzględniając oba wyniki, można wnioskować o istnieniu zależności między analizowanymi zmiennymi.</p>
</section>
</section>
<section id="zadanie-14" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-14">Zadanie 14</h2>
<p>Napisz własną funkcję do przeprowadzania analizy korespondencji. Funkcja jako argument przyjmuje tablicę dwudzielczą i zwraca obliczone wartości odpowiednich wektorów i macierzy, współrzędnych punktów oraz odpowiedni wykres.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>correspondence_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(t, <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) {</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># macierz korespondencji</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(t)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wektory częstości brzegowych</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(P)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">colSums</span>(P)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># macierz częstości wierszowych</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  D_r <span class="ot">&lt;-</span> <span class="fu">diag</span>(r)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># macierz profili wierszowych</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fu">solve</span>(D_r) <span class="sc">%*%</span> P</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># macierz częstości kolumnowych</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  D_c <span class="ot">&lt;-</span> <span class="fu">diag</span>(c)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># macierz profili kolumnowych</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">&lt;-</span> P <span class="sc">%*%</span> <span class="fu">solve</span>(D_c)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># macierz residuów standaryzowanych</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">sqrtm</span>(D_r)) <span class="sc">%*%</span> (P <span class="sc">-</span> r <span class="sc">%*%</span> <span class="fu">t</span>(c)) <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">sqrtm</span>(D_c))</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dekompozycja według wartości osobliwych macierzy</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  SVD <span class="ot">&lt;-</span> <span class="fu">svd</span>(A)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># macierze ortogonalne</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> SVD<span class="sc">$</span>u</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> SVD<span class="sc">$</span>v</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># macierz diagnolna o niezerowych wartościach osobliwych macierzy A</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ułożonych w porządku nierosnącym </span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">diag</span>(SVD<span class="sc">$</span>d)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># współrzędne kategorii cech dla wierszy</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  F <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">sqrtm</span>(D_r)) <span class="sc">%*%</span> U <span class="sc">%*%</span> D</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># współrzędne kategorii cech dla kolumn</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  G <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">sqrtm</span>(D_c)) <span class="sc">%*%</span> V <span class="sc">%*%</span> D</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(F)</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(G)</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rysowanie wykresu, typ: principal</span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>  row_std <span class="ot">&lt;-</span> F[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>  col_std <span class="ot">&lt;-</span> G[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(row_std[, <span class="dv">1</span>], col_std[, <span class="dv">1</span>]),</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">c</span>(row_std[, <span class="dv">2</span>], col_std[, <span class="dv">2</span>]),</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>                    <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">rownames</span>(t), <span class="fu">colnames</span>(t)),</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>                    <span class="at">variable =</span> <span class="fu">c</span>(<span class="fu">rep</span>(variables[<span class="dv">1</span>], <span class="fu">nrow</span>(t)), </span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">rep</span>(variables[<span class="dv">2</span>], <span class="fu">ncol</span>(t)))), </span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> variable)) <span class="sc">+</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">vjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dim 1"</span>, <span class="at">y =</span> <span class="st">"Dim 2"</span>) <span class="sc">+</span></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Korzystając z napisanej funkcji wykonano analizę korespondencji dla danych dotycząych stopnia zadowolenia ze szkoleń w kontekście dopasowania do indywidualnych potrzeb w pierwszym badanym okresie oraz stażu pracy.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(ankieta<span class="sc">$</span>PYT_2, ankieta<span class="sc">$</span>STAŻ)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">correspondence_analysis</span>(t, <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"PYT_2"</span>, <span class="st">"STAŻ"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]       [,2]          [,3]
[1,]  0.11826617  0.1622275 -2.593960e-17
[2,] -0.35056182 -0.1378599 -6.255756e-17
[3,]  3.04672664 -0.4937333 -4.883933e-17
[4,] -0.07532609 -0.0794247 -1.097916e-17
             [,1]        [,2]          [,3]
[1,] -0.003060932  0.25943499 -2.695995e-17
[2,] -0.138246087 -0.06714975 -2.695995e-17
[3,]  1.025260549 -0.06504575 -2.695995e-17</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><embed src="Kusy_Srebniak_2_files/figure-html/zad14_dane-1.pdf" class="img-fluid quarto-figure quarto-figure-center" data-fig-pos="H" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="zadania-dodatkowe" class="level1">
<h1>Zadania dodatkowe</h1>
<section id="zadania-1" class="level2">
<h2 class="anchored" data-anchor-id="zadania-1">Zadania *1</h2>
<p>Napisano funkcję, która dla dwóch wektorów danych oblicza wartość poziomu krytycznego (p-value) w teście opartym na korelacji odległości.</p>
<p>Dla wygenerowanych danych zweryfikowano hipotezę o niezależności przy użyciu napisanej funkcji.</p>
</section>
<section id="zadanie-2-1" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-2-1">Zadanie *2</h2>
<p>Dla zadanych <span class="math inline">\(\pi_1\)</span> oraz <span class="math inline">\(\pi2\)</span> pokaz ̇, z ̇e wartos ́c ́ ryzyka wzgle ̨dnego (RR) nie jest bardziej oddalona od wartos ́ci 1 (wartos ́c ́ odpowiadaja ̨ca niezalez ̇nos ́ci) niz ̇ wartos ́c ́ odpowiadaja ̨cego ilorazu szans (OR).</p>
</section>
<section id="zadanie-3-1" class="level2">
<h2 class="anchored" data-anchor-id="zadanie-3-1">Zadanie *3</h2>
<p>Niech D oznacza posiadanie pewnej choroby, a E pozostawanie wystawionym na pewny czynnik ryzyka. W badaniach epidemiologicznych definuje sie ̨ miare ̨ AR nazywana ̨ ryzykiem przypisanym (ang. attributable risk).</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>